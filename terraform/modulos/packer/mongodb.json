{
  "variables": {
    "ami_name": "mongo-actividad2",
    "ami_description": "AMI with Nginx and Nodejs Application",
    "tags": "Name=MONGO-AMI,Environment=Development",
    "aws_region": "us-east-1",
    "ami_base": "ami-00ca0754cabb20b45",
    "instance_type": "t2.micro",
    "ssh_username": "ubuntu",
    "ec2_instance_type": "t2.micro",
    "ec2_keypair_name": "danger"
  },
  "builders": [
    {
      "type": "amazon-ebs",
      "region": "{{ user `aws_region` }}",
      "source_ami": "{{ user `ami_base` }}",
      "instance_type": "{{ user `instance_type` }}",
      "ssh_username": "{{ user `ssh_username` }}",
      "ami_name": "{{ user `ami_name` }}",
      "ami_description": "{{ user `ami_description` }}",
      "encrypt_boot": false
    }
  ],
    "provisioners": [
        {
            "type": "shell",
            "inline": [
                "sudo apt update -y",
                "sudo apt install -y wget curl gnupg",
                "wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | sudo gpg --dearmor -o /usr/share/keyrings/mongodb-server-6.0.gpg",
                "echo 'deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse' | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list",
                "sudo apt update -y",
                "sudo apt install -y mongodb-org",
                "sudo systemctl enable mongod",
                "sudo systemctl start mongod",
                "sleep 5",
                "sudo systemctl status mongod --no-pager"
            ]
        }
    ]
}